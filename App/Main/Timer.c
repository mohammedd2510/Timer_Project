/**********************************************************************************************************************
 *  FILE DESCRIPTION
 *  -----------------------------------------------------------------------------------------------------------------*/
/**        \file  Timer.c 
 *        \brief  Contains Timer Application Functions implementation
 *
 *
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  INCLUDES
 *********************************************************************************************************************/
#include "Timer.h"

/**********************************************************************************************************************
*  LOCAL MACROS CONSTANT\FUNCTION
*********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL DATA 
 *********************************************************************************************************************/
static sint8 Timer_val=0; //contains the timer value 
/**********************************************************************************************************************
 *  GLOBAL DATA
 *********************************************************************************************************************/

/**********************************************************************************************************************
 *  LOCAL FUNCTION PROTOTYPES
 *********************************************************************************************************************/
static void Choose_Timer_Min(void);
static void Choose_Timer_10Secs(void);
static void Timer_On(void);

/**********************************************************************************************************************
 *  LOCAL FUNCTIONS
 *********************************************************************************************************************/
/******************************************************************************
* \Syntax          : static void Choose_Timer_Min(void)
* \Description     : choose the timer minutes from 0 to 9 min
*******************************************************************************/
static void Choose_Timer_Min(void){
	if(Timer_val/10==max_min)Timer_val-=Zero_min;
	SEVEN_SEG_DISPLAY(Timer_val+=increment_min);
}
/******************************************************************************
* \Syntax          : static void Choose_Timer_10Sec(void)
* \Description     : choose the timer 10seconds from 0 to 5  10secs
*******************************************************************************/
static void Choose_Timer_10Secs(void){
	if(Timer_val%10==max_10sec)Timer_val-=Zero_10sec;
	SEVEN_SEG_DISPLAY(Timer_val+=increment_10sec);
}
/******************************************************************************
* \Syntax          : static void Timer_On(void)
* \Description     : start the timer counter
*******************************************************************************/
static void Timer_On(void){
	uint16 ten_seconds_counter=0;
	while(1){
		if (Timer_val%10==PASSED_MINUTE)
		{
			Timer_val-=decrement_min;
			Timer_val+=Count_NEW_60_SEC;
			if(Timer_val==Timer_Finished){
				Timer_val=0;
				SEVEN_SEG_DISPLAY(Timer_val);
				BUZZ_ON();
				_delay_ms(5000);
				BUZZ_OFF();
				break;
			}
		}
		else {
			SEVEN_SEG_DISPLAY(Timer_val);
			ten_seconds_counter++;
			if(ten_seconds_counter==PASSED_TEN_SECONDS)
			{
				Timer_val-=decrement_10sec;
				ten_seconds_counter=0;
			}
		}
	}
}

/**********************************************************************************************************************
 *  GLOBAL FUNCTIONS
 *********************************************************************************************************************/
/******************************************************************************
* \Syntax          : void Timer_App(void)
* \Description     : Start The Timer App
*******************************************************************************/
void Timer_App(void){
	if(BTN_GetValue(BUTTON_0)==BUTTON_PRESSED){
		Choose_Timer_Min();
	}
	else if(BTN_GetValue(BUTTON_1)==BUTTON_PRESSED){
		Choose_Timer_10Secs();
	}
	else if (BTN_GetValue(BUTTON_2)==BUTTON_PRESSED){
		Timer_On();
	}
	else SEVEN_SEG_DISPLAY(Timer_val);
}



/**********************************************************************************************************************
 *  END OF FILE: Timer.c 
 *********************************************************************************************************************/

